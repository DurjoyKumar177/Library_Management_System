{% extends 'base.html' %}

{% block content %}
<div class="container mx-auto mt-6 bg-gray-100 p-6 rounded-lg shadow-lg">
    <div class="flex flex-col md:flex-row items-center justify-center gap-8">
        <!-- Book Image -->
        <div class="md:w-1/2 w-full">
            <img 
                src="{{ book.image.url }}" 
                alt="{{ book.title }}" 
                class="rounded-lg shadow-md w-full max-h-96 object-cover"
            />
        </div>

        <!-- Book Details -->
        <div class="bg-white p-6 rounded-lg shadow-lg md:w-1/2 w-full">
            <!-- Category Button -->
            <button 
                class="bg-blue-200 text-blue-800 px-4 py-2 rounded-lg cursor-not-allowed mb-4"
                disabled>
                {{ book.catagory.name }}
            </button>

            <!-- Book Information -->
            <h2 class="text-2xl font-bold text-gray-800 mb-4">{{ book.title }}</h2>
            <p class="mb-2 text-lg">
                <strong>Borrow Price:</strong> 
                <span class="text-green-600 font-semibold">BDT {{ book.borrowprice }}</span>
            </p>
            <p class="mb-2 text-lg">
              <strong>Quantity:</strong> 
              <span class="{% if book.quantity > 0 %}text-green-600{% else %}text-red-600{% endif %}">
                  {{ book.quantity }}
              </span>
          </p>
            <p class="mb-4 text-lg">
                <strong>Description:</strong>
                <br>{{ book.description }}
            </p>

            <!-- Borrow Button -->
            <div class="mt-4">
                {% if request.GET.source == "profile" %}
                <form method="POST" action="{% url 'borrow_book' book.id %}">
                    {% csrf_token %}
                    {% if book.quantity > 0 %}
                    <button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition">
                        Borrow Again
                    </button>
                    {% else %}
                    <button class="w-full bg-gray-300 text-gray-600 py-2 px-4 rounded-lg cursor-not-allowed" disabled>
                        Out of Stock
                    </button>
                    {% endif %}
                </form>
                {% else %}
                {% if request.user.is_authenticated %}
                <form action="{% url 'borrow_book' book.id %}" method="POST">
                    {% csrf_token %}
                    {% if book.quantity > 0 %}
                    <button class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg transition">
                        Borrow Now
                    </button>
                    {% else %}
                    <button class="w-full bg-gray-300 text-gray-600 py-2 px-4 rounded-lg cursor-not-allowed" disabled>
                        Out of Stock
                    </button>
                    {% endif %}
                </form>
                {% else %}
                <p class="text-red-500 font-semibold mt-4">Login to borrow this book.</p>
                {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
